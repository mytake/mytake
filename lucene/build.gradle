apply plugin: 'java'

String VER_LUCENE = '8.6.2'
dependencies {
	implementation project(':client-interface')
	implementation project(':factset-tooling')
	implementation 'com.diffplug.durian:durian-core:1.2.0'
	implementation 'com.diffplug.durian:durian-collect:1.2.0'
	implementation 'com.diffplug.durian:durian-io:1.2.0'
	implementation "org.apache.lucene:lucene-core:${VER_LUCENE}"
	implementation "org.apache.lucene:lucene-queryparser:${VER_LUCENE}"
	implementation "org.apache.lucene:lucene-analyzers-common:${VER_LUCENE}"
	testImplementation "junit:junit:${VER_JUNIT}"
	testImplementation "org.assertj:assertj-core:${VER_ASSERTJ}"
}

apply plugin: 'com.diffplug.spotless'
spotless {
	ratchetFrom 'origin/staging'
	java {
		licenseHeaderFile rootProject.file('gradle/spotless-license-agpl.java')
		importOrder()
		eclipse().configFile(rootProject.file('gradle/spotless.eclipseformat.xml'))
		removeUnusedImports()
	}
}

tasks.register('generateFoundation', JavaExec) {
	description = 'Generates the foundation'
	classpath = sourceSets.main.runtimeClasspath
	main = 'org.mytake.lucene.legacyfoundationgen.Index'

	dependsOn(tasks.classes)
	inputs.dir('../presidential-debates').withPathSensitivity(PathSensitivity.NAME_ONLY)
	outputs.dir('../foundation/src/main/resources')
	outputs.cacheIf { true }
}
